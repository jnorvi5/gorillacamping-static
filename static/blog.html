<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Configuration and Core Scripts -->
<script src="/js/config.js"></script>
<script src="/js/analytics.js"></script>
<script src="/js/preload.js"></script>
    <!-- Meta tags, CSS links, etc. -->
    <script src="/js/config.js"></script>
</head>
<body>
    <!-- Header, navigation, etc. -->
    <main role="main">
        <section class="blog-section">
            <h1>Guerilla Camping Blog</h1>
            <ul class="blog-list" id="blog-list">
                <li class="loading-skeleton">Loading posts...</li>
            </ul>
        </section>
    </main>
    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Use the API_URL from config
        fetch(`${CONFIG.API_URL}/api/blog-posts`)
            .then(res => {
                if (!res.ok) throw new Error('Network response failed');
                return res.json();
            })
            .then(posts => {
                const ul = document.getElementById('blog-list');
                ul.innerHTML = '';
                
                if (posts.length === 0) {
                    ul.innerHTML = '<li class="no-posts">No blog posts found. Check back soon!</li>';
                    return;
                }
                
                posts.forEach(post => {
                    const li = document.createElement('li');
                    li.className = 'blog-item';
                    li.innerHTML = `
                        <article>
                            <h2><a href="/blog/${post.slug}">${post.title}</a></h2>
                            <div class="meta">Posted on ${post.created_at}</div>
                            <p class="excerpt">${post.excerpt || 'Click to read more about this topic...'}</p>
                            <a href="/blog/${post.slug}" class="read-more">Read Full Post â†’</a>
                        </article>
                    `;
                    ul.appendChild(li);
                });
            })
            .catch(error => {
                document.getElementById('blog-list').innerHTML = 
                    '<li class="error">Error loading posts. Please try again later.</li>';
                console.error('Error fetching blog posts:', error);
            });
    });
    </script>
</body>
    <!-- Guerilla Chat Integration -->
<script src="/js/guerilla-chat.js"></script>
</html>
